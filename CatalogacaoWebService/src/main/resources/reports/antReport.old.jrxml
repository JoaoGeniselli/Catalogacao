<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN"
   "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">

<jasperReport 
    xmlns="http://jasperreports.sourceforge.net/jasperreports"             
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports
        http://jasperreports.sourceforge.net/xsd/jasperreport.xsd"
    name="antReport">

    <queryString>
    <![CDATA[
        SELECT 
            VISIT.id AS ID_ATUALIZACAO,
            NEST.nest_id AS NINHO,
            DATE_FORMAT(VISIT.collection_date, '%d/%m/%y') AS DATA,
            CITY.name AS CIDADE,
            CONCAT(INITIAL_COORDINATE.latitude,
                    ', ',
                    INITIAL_COORDINATE.longitude) AS PONTO_INICIAL,
            CONCAT(FINAL_COORDINATE.latitude,
                    ', ',
                    FINAL_COORDINATE.longitude) AS PONTO_FINAL,
            VISIT.notes AS OBSERVAÇÕES
        FROM
            data_update_visit VISIT
                JOIN
            ant_nest NEST ON (VISIT.nest_nest_id = NEST.nest_id)
                JOIN
            coordinate INITIAL_COORDINATE ON (INITIAL_COORDINATE.id = VISIT.new_begining_point_id)
                JOIN
            coordinate FINAL_COORDINATE ON (FINAL_COORDINATE.id = VISIT.new_ending_point_id)
                JOIN
            city CITY ON (NEST.city_id = CITY.id)
            ORDER BY NEST.NEST_ID;
    ]]>
    </queryString>

    <field name="ID_ATUALIZACAO" class="java.lang.Long">
        <fieldDescription><![CDATA[ID_ATUALIZACAO]]></fieldDescription>
    </field>

    <field name="NINHO" class="java.lang.Long">
        <fieldDescription><![CDATA[NINHO]]></fieldDescription>
    </field>
    
    <field name="DATA" class="java.lang.String">
        <fieldDescription><![CDATA[DATA]]></fieldDescription>
    </field>
    
    <field name="CIDADE" class="java.lang.String">
        <fieldDescription><![CDATA[CIDADE]]></fieldDescription>
    </field>

    <field name="PONTO_INICIAL" class="java.lang.String">
        <fieldDescription><![CDATA[PONTO_INICIAL]]></fieldDescription>
    </field>
    
    <field name="PONTO_FINAL" class="java.lang.String">
        <fieldDescription><![CDATA[PONTO_FINAL]]></fieldDescription>
    </field>
    
    <field name="OBSERVAÇÕES" class="java.lang.String">
        <fieldDescription><![CDATA[ OBSERVAÇÕES]]></fieldDescription>
    </field>

    <detail>
        <band height="51" splitType="Stretch">
            <textField>
                <reportElement x="0" y="0" width="100" height="20"/>
                <textElement/>
                <textFieldExpression class="java.lang.String">
                  <![CDATA[$F{ID_ATUALIZACAO}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="100" y="0" width="100" height="20"/>
                <textElement/>
                <textFieldExpression class="java.lang.String">
                  <![CDATA[$F{NINHO}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="200" y="0" width="100" height="20"/>
                <textElement/>
                <textFieldExpression class="java.lang.String">
                  <![CDATA[$F{DATA}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="300" y="0" width="150" height="20"/>
                <textElement/>
                <textFieldExpression class="java.lang.String">
                  <![CDATA[$F{CIDADE}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="450" y="0" width="150" height="20"/>
                <textElement/>
                <textFieldExpression class="java.lang.String">
                  <![CDATA[$F{PONTO_INICIAL}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="600" y="0" width="150" height="20"/>
                <textElement/>
                <textFieldExpression class="java.lang.String">
                  <![CDATA[$F{PONTO_FINAL}]]></textFieldExpression>
            </textField>
            
            <textField>
                <reportElement x="750" y="0" width="600" height="20"/>
                <textElement/>
                <textFieldExpression class="java.lang.String">
                  <![CDATA[$F{OBSERVAÇÕES}]]></textFieldExpression>
            </textField>
        </band>
    </detail>

</jasperReport>